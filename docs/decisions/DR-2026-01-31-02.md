# DR-2026-01-31-02: Discord Integration (Messaging Platform Notifications)

**Decision ID:** DR-2026-01-31-02
**Status:** Accepted
**Date:** 2026-01-31
**Deciders:** User (David)

#### Context
Users want automated notifications when votes are created and closed. Discord is the first messaging platform to support, but the architecture should allow for future integrations (Slack, email, etc.).

#### Source Prompt
> "Second, I want a first party integration with Discord. This may be the first of many integrations with 'messaging' platforms."
>
> "Ultimately together: the end result is every week, a vote is created, the designated Discord server channel gets a message with links to vote and to see results. Then it auto closes and notifies the same group that the voting closed."

#### Options Considered
- **Option A: Discord-only, vote-level configuration**
  - Each vote can have a Discord webhook URL
  - Notifications sent on vote lifecycle events
- **Option B: Abstracted integrations linked to votes**
  - Integrations table supports multiple platforms
  - Recurring votes link to integrations for notifications
  - Designed for extensibility (Discord, Slack, webhooks)
- **Option C: Global webhook configuration**
  - Single webhook URL in environment variables
  - All votes notify the same channel

#### Decision
Implement Option B - Abstracted integrations with vote-level configuration.

#### Rationale
- Extensible architecture for future messaging platforms
- Vote-level integration makes sense (recurring votes notify same channel)
- One-off votes can also use integrations if desired
- Fire-and-forget notifications don't block vote operations
- Clean separation: integrations service handles all messaging logic

#### Consequences
- New `integrations` table with type field (discord, slack, webhook)
- Votes reference integration by ID
- Discord service uses webhook API (no bot required)
- Notification events: vote_created, vote_closed
- Notifications include: vote title, voting link (with secret), results link
- Error handling: log failures but don't block vote operations

#### Scope
- [x] UX / product behavior
- [x] Data model
- [x] Other: Third-party API integration

#### Notes
- Discord webhooks are simpler than bot tokens (no OAuth flow)
- Webhook URL is sensitive and stored securely
- Future platforms can implement the same interface
- Notifications are fire-and-forget to avoid blocking main flow

---
